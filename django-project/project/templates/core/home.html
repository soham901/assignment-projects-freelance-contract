{% extends './base.html' %}

{% load static %}

{% block head %}
<script>
window.onload = function () {
  var chart= new CanvasJS.Chart("chartContainer", {
    theme: "light2",
    title: {
      text: "Last {{ data|length }} Records"
    },
    axisY: {
      title: "Stock Amount",
      stripLines: [{
        value: 10000,
        label: "Goal"
      }]
    },
    data: [{
      type: "line",
      yValueFormatString: "#,### Steps",
      dataPoints: {{ chart_data|safe }}
    }]
  });
  chart.render();
}
</script>
{% endblock %}

{% block content %}

<h2>Basic Analytics of Last 32 records</h2>
<table border="1" width="100%" style="text-align: center;">
<tr>
    <td>Maximum</td>
    <td>{{ max }}</td>
</tr>
<tr>
    <td>Minimum</td>
    <td>{{ min }}</td>
</tr>
<tr>
    <td>Average</td>
    <td>{{ avg }}</td>
</tr>
</table>

<hr style="margin: 1rem 0rem" />

<h2 style="margin: .4rem 0 0 0;">Stocks</h2>

<p style="margin: 0 0 .4rem 0;">Note: The background color of the amount is red if the amount is greater than the average, otherwise green.</p>

<table border="1" width="100%" style="text-align: center;">
    <tr>
        <th>Stock ID</th>
        <th>Amount</th>
        <th>Created At</th>
    </tr>
{% for stock in data %}
    <tr>
        <td>{{ stock.id }}</td>
        <td style="background-color: {% if stock.amount > avg %} #FF7F7F {% else %} #90EE90 {% endif %};">{{ stock.amount }}</td>
        <td>{{ stock.created_at }}</td>
    </tr>
{% endfor %}
</table>

<div>Total records: {{ data|length }}</div>

<hr style="margin: 1rem 0rem" />


<div id="chartContainer" style="width: 100%; height: 360px;"></div>
<script src="{% static 'canvasjs.min.js' %}"></script>

{% endblock %}
